CREATE TABLE VENDAS_POR_VENDEDOR(
	IDVENDEDOR INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR (30),
	SEXO CHAR (1),
	JANEIRO FLOAT (10,2),
	FEVEREIRO FLOAT (10,2),
	MARCO FLOAT (10,2)
	);
	
	INSERT INTO VENDAS_POR_VENDEDOR (NOME, SEXO, JANEIRO, FEVEREIRO, MARCO) VALUES
('Alice Silva', 'F', 1200.50, 1350.75, 1420.80),
('Bruno Costa', 'M', 980.00, 1025.60, 1100.40),
('Carla Souza', 'F', 1450.80, 1520.90, 1600.70),
('Daniel Pereira', 'M', 800.00, 850.20, 900.30),
('Eva Lima', 'F', 1100.40, 1175.50, 1250.60),
('Fernando Oliveira', 'M', 1300.70, 1375.90, 1450.20),
('Gabriela Santos', 'F', 920.50, 970.75, 1025.60),
('Henrique Almeida', 'M', 1050.80, 1100.40, 1150.70),
('Isabela Fernandes', 'F', 1000.00, 1050.20, 1100.30),
('João Batista', 'M', 850.40, 900.50, 950.60);

/*MAXIMA, MINIMA E MEDIA*/

SELECT MAX(FEVEREIRO) AS MAIOR_FEV
    -> FROM VENDAS_VENDEDOR;
	
SELECT MIN(MARCO) AS MIN_MAR
FROM VENDAS_VENDEDOR;

SELECT AVG(JANEIRO) AS MEDIA_JAN
FROM VENDAS_VENDEDOR;

SELECT MAX(JANEIRO) AS MAX_JAN,
MIN(JANEIRO) AS MIN_JAN,
AVG(JANEIRO) AS MEDIA_JAN
FROM VENDAS_VENDEDOR ;

/*TRUNCATE PARA DEIXAR A QUANTIDADE DE CASAS DECIMAIS*/

SELECT MAX(JANEIRO) AS MAX_JAN,
MIN(JANEIRO) AS MIN_JAN,
TRUNCATE(AVG(JANEIRO), 2) AS MEDIA_JAN
FROM VENDAS_VENDEDOR ;

/*SOMA SUM()*/

SELECT SUM(JANEIRO) AS TOTAL_JAN,
SUM(FEVEREIRO) AS TOTAL_FEV,
SUM(MARCO) AS TOTAL_MAR
FROM VENDAS_VENDEDOR;

/* VENDAS POR SEXO*/

SELECT SEXO, SUM(MARCO) AS TOTAL_MARCO
FROM VENDAS_VENDEDOR
GROUP BY SEXO;

/* QUAL VENDEDOR VENDEU MENOS EM MARCO E O SEU NOME*/

SELECT NOME, MARCO
FROM VENDAS_VENDEDOR
WHERE MARCO =(SELECT MIN(MARCO) FROM VENDAS_VENDEDOR);

/* QUAL VENDEDOR VENDEU MAIS MARCO */

SELECT NOME, MARCO
FROM VENDAS_VENDEDOR
WHERE MARCO =(SELECT MAX(MARCO) FROM VENDAS_VENDEDOR);

/* QUEM VENDEU MAIS DO QUE A MEDIA DE FEVEREIRO*/

SELECT NOME, MARCO
FROM VENDAS_VENDEDOR
WHERE MARCO > (SELECT AVG(FEVEREIRO) FROM VENDAS_VENDEDOR);

/*SOMA POR LINHA*/

SELECT NOME, 
JANEIRO,
FEVEREIRO,
MARCO,
(JANEIRO+FEVEREIRO+MARCO) AS 'TOTAL DO TRI',
TRUNCATE((JANEIRO+FEVEREIRO+MARCO)/3, 2) AS 'MÉDIA DO TRI'
FROM VENDAS_VENDEDOR;

/* COLOCANDO PORCENTAGEM */

SELECT NOME, 
JANEIRO,
FEVEREIRO,
MARCO,
(JANEIRO+FEVEREIRO+MARCO) AS 'TOTAL DO TRI',
TRUNCATE((JANEIRO+FEVEREIRO+MARCO)* .25, 2) AS 'DESCONTO DO TRI',
TRUNCATE((JANEIRO+FEVEREIRO+MARCO)/3, 2) AS 'MÉDIA DO TRI'
FROM VENDAS_VENDEDOR;


CREATE TABLE REGIONAL(
IDREGIONAL INT PRIMARY KEY AUTO_INCREMENT,
CIDADE VARCHAR (50),
UF VARCHAR (2),
PAIS VARCHAR (30)
);


CREATE TABLE VENDAS_VENDEDOR(
	IDVENDEDOR INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR (30),
	SEXO CHAR (1),
	IDREGIONAL INT,
	FOREIGN KEY(IDREGIONAL)
	REFERENCES REGIONAL(IDREGIONAL),
	JANEIRO FLOAT (10,2),
	FEVEREIRO FLOAT (10,2),
	MARCO FLOAT (10,2)
	);
	
	INSERT INTO VENDAS_VENDEDOR (NOME, SEXO, IDREGIONAL, JANEIRO, FEVEREIRO, MARCO) VALUES
('Alice Silva', 'F', 1, 1200.50, 1350.75, 1420.80),
('Bruno Costa', 'M', 2,980.00, 1025.60, 1100.40),
('Carla Souza', 'F', 1, 1450.80, 1520.90, 1600.70),
('Daniel Pereira', 'M', 3, 800.00, 850.20, 900.30),
('Eva Lima', 'F', 4, 1100.40, 1175.50, 1250.60),
('Fernando Oliveira', 'M', 1, 1300.70, 1375.90, 1450.20),
('Gabriela Santos', 'F', 2, 920.50, 970.75, 1025.60),
('Henrique Almeida', 'M', 3, 1050.80, 1100.40, 1150.70),
('Isabela Fernandes', 'F', 5, 1000.00, 1050.20, 1100.30),
('João Batista', 'M', 5, 850.40, 900.50, 950.60);

INSERT INTO REGIONAL (IDREGIONAL, CIDADE, UF, PAIS) VALUES
(1, 'SÃO PAULO', 'SP', 'BRASIL'),
(2, 'OSASCO', 'SP', 'BRASIL'),
(3, 'RIO DE JANEITO', 'RJ', 'BRASIL'),
(4, 'BELO HORIZONTE', 'BH', 'BRASIL'),
(5, 'PARANÁ', 'PR', 'BRASIL')
;

CREATE TABLE REGIONAL(
IDREGIONAL INT,
CIDADE VARCHAR (50),
UF VARCHAR (2),
PAIS VARCHAR (30)
);


CREATE TABLE VENDAS_VENDEDOR(
	IDVENDEDOR INT,
	NOME VARCHAR (30),
	SEXO CHAR (1),
	IDREGIONAL INT,
	JANEIRO FLOAT (10,2),
	FEVEREIRO FLOAT (10,2),
	MARCO FLOAT (10,2)
	);

ALTER TABLE VENDAS_VENDEDOR ADD CONSTRAINT FK_REGIONAL_VENDEDOR
FOREIGN KEY(IDREGIONAL)
REFERENCES REGIONAL(IDREGIONAL);

ALTER TABLE REGIONAL ADD CONSTRAINT PK_REGIONAL
PRIMARY KEY(IDREGIONAL);